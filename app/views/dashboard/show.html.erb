<!-- Dashboard / Matching Center -->
<div class="max-w-lg md:max-w-3xl lg:max-w-5xl mx-auto px-4 md:px-6 py-6">
  <div class="animate-fade-in-up">

    <% if @user.strong_subject.blank? || @user.weak_subject.blank? %>
      <!-- Profile Incomplete Warning -->
      <div class="bg-amber-50 border border-amber-200 rounded-2xl p-4 mb-6 animate-slide-up">
        <div class="flex items-start gap-3">
          <div class="w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0">
            <i class="fa-solid fa-triangle-exclamation text-amber-600"></i>
          </div>
          <div>
            <h3 class="font-semibold text-amber-800 text-sm">กรอกโปรไฟล์ให้ครบก่อนนะ!</h3>
            <p class="text-amber-600 text-xs mt-1">กรุณากรอกวิชาที่ถนัดและวิชาที่อ่อน เพื่อจับคู่เพื่อนติว</p>
            <%= link_to edit_profile_path, class: "inline-flex items-center gap-1.5 mt-2 px-4 py-2 bg-amber-500 text-white rounded-lg text-xs font-medium hover:bg-amber-600 transition-colors" do %>
              <i class="fa-solid fa-pen"></i>
              กรอกโปรไฟล์
            <% end %>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Desktop 2-column layout -->
    <div class="lg:grid lg:grid-cols-3 lg:gap-6">

      <!-- Left Column: Profile & Stats -->
      <div class="lg:col-span-1 space-y-4 mb-6 lg:mb-0">
        <!-- Profile Card -->
        <div class="bg-white dark:bg-slate-800 rounded-2xl border border-gray-100 dark:border-slate-700 shadow-sm p-6 text-center">
          <div class="w-20 h-20 rounded-full overflow-hidden ring-4 ring-sky-100 mx-auto mb-4">
            <img src="https://api.dicebear.com/9.x/adventurer/svg?seed=<%= @user.name %>&backgroundColor=b6e3f4" alt="avatar" class="w-full h-full object-cover">
          </div>
          <h1 class="text-lg font-bold text-gray-800 dark:text-gray-100"><%= @user.name %></h1>
          <p class="text-xs text-gray-400 mt-1">
            <% if @user.faculty.present? %>
              <i class="fa-solid fa-building text-gray-300 mr-1"></i>คณะ<%= @user.faculty %>
            <% end %>
            <% if @user.weak_subject.present? %>
              · อยากเก่ง<%= @user.weak_subject %>
            <% end %>
          </p>

          <!-- Stats -->
          <div class="grid grid-cols-2 gap-3 mt-5">
            <div class="bg-sky-50 rounded-xl p-3 text-center border border-sky-100">
              <i class="fa-solid fa-users text-sky-500 mb-1"></i>
              <span class="text-xl font-bold text-sky-600 block"><%= @matches.count %></span>
              <span class="text-[10px] text-gray-400 block">เพื่อนที่ Match</span>
            </div>
            <div class="bg-indigo-50 rounded-xl p-3 text-center border border-indigo-100">
              <i class="fa-solid fa-comment text-indigo-500 mb-1"></i>
              <span class="text-xl font-bold text-indigo-600 block"><%= @chat_rooms.count %></span>
              <span class="text-[10px] text-gray-400 block">ห้องแชท</span>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="space-y-2">
          <%= link_to create_ai_chat_path, method: :post, class: "flex items-center gap-3 bg-white dark:bg-slate-800 rounded-xl border border-gray-100 dark:border-slate-700 shadow-sm p-4 hover:border-amber-200 hover:shadow-md transition-all group", data: { turbo_method: :post } do %>
            <div class="w-10 h-10 bg-amber-500 rounded-xl flex items-center justify-center flex-shrink-0">
              <i class="fa-solid fa-robot text-white"></i>
            </div>
            <div class="flex-1 min-w-0">
              <p class="font-medium text-gray-800 dark:text-gray-100 text-sm group-hover:text-amber-500 transition-colors">AI ติวเตอร์</p>
              <p class="text-xs text-gray-400">ถามคำถามเรื่องเรียนกับ AI</p>
            </div>
            <i class="fa-solid fa-chevron-right text-gray-300 text-xs"></i>
          <% end %>

          <%= link_to chat_rooms_path, class: "flex items-center gap-3 bg-white dark:bg-slate-800 rounded-xl border border-gray-100 dark:border-slate-700 shadow-sm p-4 hover:border-emerald-200 hover:shadow-md transition-all group" do %>
            <div class="w-10 h-10 bg-emerald-500 rounded-xl flex items-center justify-center flex-shrink-0">
              <i class="fa-solid fa-comments text-white"></i>
            </div>
            <div class="flex-1 min-w-0">
              <p class="font-medium text-gray-800 dark:text-gray-100 text-sm group-hover:text-emerald-500 transition-colors">ห้องแชทของฉัน</p>
              <p class="text-xs text-gray-400">ดูการสนทนาทั้งหมด</p>
            </div>
            <i class="fa-solid fa-chevron-right text-gray-300 text-xs"></i>
          <% end %>
        </div>

        <!-- Powered by AI -->
        <div class="text-center pt-2">
          <span class="inline-flex items-center gap-1.5 text-[10px] text-gray-400 font-medium bg-white px-3 py-1.5 rounded-full border border-gray-100 shadow-sm">
            <i class="fa-solid fa-wand-magic-sparkles text-sky-500"></i> Powered by AI
          </span>
        </div>
      </div>

      <!-- Right Column: Search & Matches -->
      <div class="lg:col-span-2 space-y-6">
        <!-- Search Hero -->
        <div class="bg-white dark:bg-slate-800 rounded-2xl border border-gray-100 dark:border-slate-700 shadow-sm p-8 text-center">
          <div class="relative w-32 h-32 md:w-40 md:h-40 mx-auto mb-6">
            <!-- Radar rings -->
            <div class="absolute inset-0 rounded-full border-2 border-sky-200/60 animate-radar-ping"></div>
            <div class="absolute inset-4 rounded-full border-2 border-sky-300/60 animate-radar-ping" style="animation-delay: 0.5s"></div>
            <div class="absolute inset-8 rounded-full border-2 border-sky-400/60 animate-radar-ping" style="animation-delay: 1s"></div>
            <!-- Center -->
            <div class="absolute inset-0 flex items-center justify-center">
              <div class="w-16 h-16 md:w-20 md:h-20 bg-sky-500 rounded-full flex items-center justify-center shadow-lg shadow-sky-500/20">
                <i class="fa-solid fa-magnifying-glass text-white text-xl md:text-2xl"></i>
              </div>
            </div>
          </div>

          <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-1">ตามหาบัดดี้ของคุณ</h3>
          <p class="text-gray-500 text-sm mb-6">เลือกวิชาและสไตล์ที่ชอบได้เลย</p>

          <%= link_to matches_path, class: "inline-flex items-center gap-2 px-8 py-3.5 bg-sky-500 hover:bg-sky-600 text-white font-semibold rounded-xl shadow-lg shadow-sky-500/20 active:scale-95 transition-all duration-200 text-sm" do %>
            <i class="fa-solid fa-magnifying-glass"></i>
            ค้นหาบัดดี้
          <% end %>
        </div>

        <!-- Recent Matches -->
        <% if @matches.any? %>
          <div>
            <div class="flex justify-between items-center mb-3">
              <h3 class="font-semibold text-sm text-gray-700 flex items-center gap-2">
                <i class="fa-solid fa-users text-sky-500"></i>
                เพื่อนที่ Match กับคุณ
              </h3>
              <%= link_to matches_path, class: "text-sky-500 text-xs font-medium hover:text-sky-600 flex items-center gap-1" do %>
                ดูทั้งหมด
                <i class="fa-solid fa-arrow-right text-[10px]"></i>
              <% end %>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-2 gap-3">
              <% @matches.first(4).each_with_index do |match, i| %>
                <div class="bg-white dark:bg-slate-800 rounded-xl border border-gray-100 dark:border-slate-700 shadow-sm p-4 flex items-center gap-3 animate-card-pop hover:border-sky-200 hover:shadow-md transition-all" style="animation-delay: <%= i * 0.1 %>s">
                  <div class="w-11 h-11 rounded-full overflow-hidden ring-2 ring-indigo-100 flex-shrink-0">
                    <img src="https://api.dicebear.com/9.x/shapes/svg?seed=<%= match.faculty %><%= match.id %>&backgroundColor=e0e7ff" alt="avatar" class="w-full h-full object-cover">
                  </div>
                  <div class="flex-1 min-w-0">
                    <p class="font-medium text-gray-800 text-sm">เพื่อนติวปริศนา</p>
                    <p class="text-xs text-gray-400 truncate">
                      <i class="fa-solid fa-star text-yellow-400 text-[10px]"></i>
                      ถนัด <%= match.strong_subject %> · คณะ<%= match.faculty %>
                    </p>
                  </div>
                  <%= button_to start_chat_match_path(match), method: :post, class: "px-3 py-1.5 bg-sky-500 hover:bg-sky-600 text-white rounded-lg text-xs font-medium transition-colors whitespace-nowrap flex items-center gap-1 shadow-sm" do %>
                    <i class="fa-solid fa-comment text-[10px]"></i>
                    ทักเลย
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        <% else %>
          <!-- Empty State -->
          <div class="bg-white dark:bg-slate-800 rounded-2xl border border-gray-100 dark:border-slate-700 shadow-sm p-10 text-center">
            <div class="w-20 h-20 bg-gray-100 dark:bg-slate-700 rounded-full flex items-center justify-center mx-auto mb-4">
              <i class="fa-solid fa-ghost text-gray-300 text-3xl"></i>
            </div>
            <p class="font-semibold text-gray-700 text-sm mb-1">ยังไม่พบเพื่อนที่ Match</p>
            <p class="text-gray-400 text-xs">กรอกโปรไฟล์ให้ครบ แล้วกดค้นหาบัดดี้เลย!</p>
          </div>
        <% end %>
      </div>
    </div>

  </div>
</div>
